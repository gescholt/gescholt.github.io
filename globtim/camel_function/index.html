<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content=""> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Camel Function | Georgy Scholten </title> <meta name="author" content="Georgy Scholten"> <meta name="description" content="A simple, whitespace theme for academics. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, mathematics, real algebraic geometry, optimization"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="" integrity="" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href=""> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ghscholt.github.io/globtim/camel_function/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-J4DJBN21KT"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-J4DJBN21KT");</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Georgy Scholten </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">Georgy Scholten </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item active"> <a class="nav-link" href="/globtim/">Globtim <span class="sr-only">(current)</span> </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> <div class="post"> <header class="post-header"> <h1 class="post-title">Camel Function</h1> <p class="post-meta"> Created in September 18, 2024 </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="run-through-six-hump-camel-function">Run Through Six-hump Camel Function</h2> <p>We show the step by step process of running out method to compute all local minimizers of the Camel function,</p> \[f(x_1, x_2)= (4-2.1 x_1^2 + \frac{x_1^4}{3})x_1^2 + x_1x_2 + (-4 + 4x_2^2)x_2^2,\] <p>which is defined over the square \([-5,5]^2\).</p> <p>We recommend running the notebook example in <code class="language-plaintext highlighter-rouge">Examples/camel_2d.ipynb</code> as a first example to get familiar with the package.</p> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">Globtim</span>

<span class="c"># Domain</span>
<span class="kd">const</span> <span class="n">n</span><span class="x">,</span> <span class="n">a</span><span class="x">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="x">,</span> <span class="mi">5</span><span class="x">,</span> <span class="mi">1</span>
<span class="kd">const</span> <span class="n">scale_factor</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>

<span class="c"># Sampling parameters</span>
<span class="kd">const</span> <span class="n">delta</span><span class="x">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="o">.</span><span class="mi">9</span> <span class="x">,</span> <span class="mi">8</span> <span class="o">/</span> <span class="mi">10</span>

<span class="c"># Define the tolerance for the L2-norm</span>
<span class="n">d</span> <span class="o">=</span> <span class="mi">6</span> <span class="c"># Initial Degree</span>
<span class="kd">const</span> <span class="n">tol_l2</span> <span class="o">=</span> <span class="mf">3e-4</span>

<span class="c"># Set the objective function</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">camel</span>
</code></pre></div></div> <p>We construct the discrete least squares polynomial (DLSP) approximant. We iterate increasing the decree of the approximant until the discrete \(L^2\)-norm is smaller than the threshold <code class="language-plaintext highlighter-rouge">tol_l2</code>.</p> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="nb">true</span> <span class="c"># Potential infinite loop</span>
    <span class="kd">global</span> <span class="n">poly_approx</span> <span class="o">=</span> <span class="n">MainGenerate</span><span class="x">(</span><span class="n">f</span><span class="x">,</span> <span class="mi">2</span><span class="x">,</span> <span class="n">d</span><span class="x">,</span> <span class="n">delta</span><span class="x">,</span> <span class="n">alpha</span><span class="x">,</span> <span class="n">scale_factor</span><span class="x">,</span> <span class="mf">0.2</span><span class="x">)</span> <span class="c"># computes the approximant in Chebyshev basis</span>
    <span class="k">if</span> <span class="n">poly_approx</span><span class="o">.</span><span class="n">nrm</span> <span class="o">&lt;</span> <span class="n">tol_l2</span>
        <span class="n">println</span><span class="x">(</span><span class="s">"attained the desired L2-norm: "</span><span class="x">,</span> <span class="n">poly_approx</span><span class="o">.</span><span class="n">nrm</span><span class="x">)</span>
        <span class="n">break</span>
    <span class="k">else</span>
        <span class="n">println</span><span class="x">(</span><span class="s">"current L2-norm: "</span><span class="x">,</span> <span class="n">poly_approx</span><span class="o">.</span><span class="n">nrm</span><span class="x">)</span>
        <span class="n">println</span><span class="x">(</span><span class="s">"Number of samples: "</span><span class="x">,</span> <span class="n">poly_approx</span><span class="o">.</span><span class="n">N</span><span class="x">)</span>
        <span class="kd">global</span> <span class="n">d</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div> <p>Once we have the coefficients of the polynomial approximant, we construct the polynomial system of partial derivatives using the <code class="language-plaintext highlighter-rouge">DynamicalPolynomials</code> environment, then we solve it using <code class="language-plaintext highlighter-rouge">HomotopyContinuation</code> in this first examples. Alternatively, one could use symbolic methods.</p> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">DynamicPolynomials</span><span class="x">,</span> <span class="n">HomotopyContinuation</span><span class="x">,</span> <span class="n">ProgressLogging</span><span class="x">,</span> <span class="n">DataFrames</span>
<span class="nd">@polyvar</span><span class="x">(</span><span class="n">x</span><span class="x">[</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span><span class="x">])</span>
<span class="n">ap</span> <span class="o">=</span> <span class="n">main_nd</span><span class="x">(</span><span class="n">n</span><span class="x">,</span> <span class="n">d</span><span class="x">,</span> <span class="n">poly_approx</span><span class="o">.</span><span class="n">coeffs</span><span class="x">)</span>
<span class="n">PolynomialApproximant</span> <span class="o">=</span> <span class="n">sum</span><span class="x">(</span><span class="kt">Float64</span><span class="o">.</span><span class="x">(</span><span class="n">ap</span><span class="x">)</span> <span class="o">.*</span> <span class="n">MonomialVector</span><span class="x">(</span><span class="n">x</span><span class="x">,</span> <span class="mi">0</span><span class="o">:</span><span class="n">d</span><span class="x">))</span> <span class="c"># Convert coefficients to Float64 for homotopy continuation</span>
<span class="n">grad</span> <span class="o">=</span> <span class="n">differentiate</span><span class="o">.</span><span class="x">(</span><span class="n">PolynomialApproximant</span><span class="x">,</span> <span class="n">x</span><span class="x">)</span>
<span class="n">sys</span> <span class="o">=</span> <span class="n">System</span><span class="x">(</span><span class="n">grad</span><span class="x">)</span>
<span class="n">Real_sol_lstsq</span> <span class="o">=</span> <span class="n">HomotopyContinuation</span><span class="o">.</span><span class="n">solve</span><span class="x">(</span><span class="n">sys</span><span class="x">)</span>
<span class="n">real_pts</span> <span class="o">=</span> <span class="n">HomotopyContinuation</span><span class="o">.</span><span class="n">real_solutions</span><span class="x">(</span><span class="n">Real_sol_lstsq</span><span class="x">;</span> <span class="n">only_real</span><span class="o">=</span><span class="nb">true</span><span class="x">,</span> <span class="n">multiple_results</span><span class="o">=</span><span class="nb">false</span><span class="x">)</span>
</code></pre></div></div> <p>Then we sort the critical points we found and retain only the ones that fall into the domain of definition and collect them into a dataframe structure.</p> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">condition</span><span class="x">(</span><span class="n">point</span><span class="x">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">point</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">point</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span> <span class="o">&lt;</span> <span class="mi">1</span>
<span class="n">filtered_points</span> <span class="o">=</span> <span class="n">filter</span><span class="x">(</span><span class="n">condition</span><span class="x">,</span> <span class="n">real_pts</span><span class="x">)</span>
<span class="n">h_x</span> <span class="o">=</span> <span class="kt">Float64</span><span class="x">[</span><span class="n">point</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span> <span class="k">for</span> <span class="n">point</span> <span class="k">in</span> <span class="n">filtered_points</span><span class="x">]</span>
<span class="n">h_y</span> <span class="o">=</span> <span class="kt">Float64</span><span class="x">[</span><span class="n">point</span><span class="x">[</span><span class="mi">2</span><span class="x">]</span> <span class="k">for</span> <span class="n">point</span> <span class="k">in</span> <span class="n">filtered_points</span><span class="x">]</span>
<span class="n">h_z</span> <span class="o">=</span> <span class="n">map</span><span class="x">(</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="n">f</span><span class="x">([</span><span class="n">p</span><span class="x">[</span><span class="mi">1</span><span class="x">],</span> <span class="n">p</span><span class="x">[</span><span class="mi">2</span><span class="x">]]),</span> <span class="n">zip</span><span class="x">(</span><span class="n">scale_factor</span> <span class="o">*</span> <span class="n">h_x</span><span class="x">,</span> <span class="n">scale_factor</span> <span class="o">*</span> <span class="n">h_y</span><span class="x">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="x">(</span><span class="n">x</span><span class="o">=</span><span class="n">scale_factor</span> <span class="o">*</span> <span class="n">h_x</span><span class="x">,</span> <span class="n">y</span><span class="o">=</span><span class="n">scale_factor</span> <span class="o">*</span> <span class="n">h_y</span><span class="x">,</span> <span class="n">z</span><span class="o">=</span> <span class="n">h_z</span><span class="x">)</span>
</code></pre></div></div> <p>We obtain the following 15 critical points plotted in orange, 6 of them are local minimizers of <code class="language-plaintext highlighter-rouge">f</code>.</p> <div style="text-align: center;"> <img src="../assets/img/camel_6humps.png" alt="Six-hump Camel Function" width="500"> </div> <p><br><br><br></p> <h2 id="what-if-there-is-noise-">What If There Is Noise ?</h2> <p>Let us assume a Gaussian noise affects the evaluation of the following <code class="language-plaintext highlighter-rouge">CrossInTray</code> function:</p> \[f(x, y) = \frac{-1}{1000} \left( \left\vert \sin(x) \sin(y) \exp \left( \left\vert 100 - \frac{\sqrt{x^2 + y^2}}{\pi} \right\vert \right) \right\vert + 1 \right)^{\frac{1}{10}}.\] <p>We define the noisy version of the <code class="language-plaintext highlighter-rouge">CrossInTray</code> objective function</p> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">Distributions</span>

<span class="k">function</span><span class="nf"> noisy_CrossInTray</span><span class="x">(</span><span class="n">xx</span><span class="o">::</span><span class="kt">Vector</span><span class="x">{</span><span class="kt">Float64</span><span class="x">};</span> <span class="n">mean</span><span class="o">::</span><span class="kt">Float64</span><span class="o">=</span><span class="mf">0.0</span><span class="x">,</span> <span class="n">stddev</span><span class="o">::</span><span class="kt">Float64</span><span class="o">=</span><span class="mf">1.0</span><span class="x">)</span><span class="o">::</span><span class="kt">Float64</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">rand</span><span class="x">(</span><span class="n">Normal</span><span class="x">(</span><span class="n">mean</span><span class="x">,</span> <span class="n">stddev</span><span class="x">))</span>
    <span class="k">return</span> <span class="n">CrossInTray</span><span class="x">(</span><span class="n">xx</span><span class="x">)</span> <span class="o">+</span> <span class="n">noise</span>
<span class="k">end</span>
</code></pre></div></div> <p>First, we re-iterate the procedure described above, we capture all local minima at degree $d=11$, with tolerance set to <code class="language-plaintext highlighter-rouge">tol_l2=3e-2</code>. We notice that we also find some critical points along the spikes of the function (the red cross of points at the level <code class="language-plaintext highlighter-rouge">z=0</code>). Those spikes are present in the function, but hard to detect by sampling points, one can see them as a set of measure \(0\) in \([-10, 10]^2\). Because of the symmetry of the function and of our sampling scheme, the approximant admits critical points exactly along these ridges and detects the spikes of the <code class="language-plaintext highlighter-rouge">CrossInTray</code> function.</p> <iframe src="/assets/plotly/CrossInTray/CrossInTray_surf_exact.html" width="100%" height="800px" frameborder="0"></iframe> <p>We reset the starting degree and slightly relax the tolerance in the \(L^2\)-norm, which is not necessary in the current example.</p> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">d</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">noisy_tol_l2</span> <span class="o">=</span> <span class="mf">4e-2</span>
</code></pre></div></div> <p>We run the sae loop to construct an accurate approximant, the last input of <code class="language-plaintext highlighter-rouge">MainGenerate</code>, which is set to <code class="language-plaintext highlighter-rouge">0.5</code>, is a relaxing factor on the number of samples we consider in the construction. Setting it to <code class="language-plaintext highlighter-rouge">1</code> makes the computations of the polynomial approx <code class="language-plaintext highlighter-rouge">poly_approx</code> consider more samples. This can make the calculations slower on more difficult examples, in exchange, we can attain the desired probabilistic guarantees on the accuracy of the approximant.</p> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="nb">true</span> <span class="c"># Potential infinite loop</span>
    <span class="kd">global</span> <span class="n">poly_approx_noisy</span> <span class="o">=</span> <span class="n">MainGenerate</span><span class="x">(</span><span class="n">f</span><span class="x">,</span> <span class="mi">2</span><span class="x">,</span> <span class="n">d</span><span class="x">,</span> <span class="n">delta</span><span class="x">,</span> <span class="n">alpha</span><span class="x">,</span> <span class="n">scale_factor</span><span class="x">,</span> <span class="mf">0.5</span><span class="x">)</span>
    <span class="k">if</span> <span class="n">poly_approx_noisy</span><span class="o">.</span><span class="n">nrm</span> <span class="o">&lt;</span> <span class="n">noisy_tol_l2</span>
        <span class="n">println</span><span class="x">(</span><span class="s">"attained the desired L2-norm: "</span><span class="x">,</span> <span class="n">poly_approx_noisy</span><span class="o">.</span><span class="n">nrm</span><span class="x">)</span>
        <span class="n">break</span>
    <span class="k">else</span>
        <span class="n">println</span><span class="x">(</span><span class="s">"current L2-norm: "</span><span class="x">,</span> <span class="n">poly_approx_noisy</span><span class="o">.</span><span class="n">nrm</span><span class="x">)</span>
        <span class="n">println</span><span class="x">(</span><span class="s">"Number of samples: "</span><span class="x">,</span> <span class="n">poly_approx_noisy</span><span class="o">.</span><span class="n">N</span><span class="x">)</span>
        <span class="kd">global</span> <span class="n">d</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div> <p>In red, we observe the critical points of the approximant in the noiseless case. In orange, we display the critical points of the approximant of the current example, constructed on the (noisy) blue cloud of points. <strong>By clicking on the labels in the plot below, turn on/off the display of that point-set in the plot.</strong></p> <iframe src="/assets/plotly/CrossInTray/Noisy_CrossInTray.html" width="100%" height="800px" frameborder="0"></iframe> <div style="text-align: center; margin-top: 10px;"> <strong>Legend:</strong> <span style="color: red;">Red - Noiseless Critical Points</span>, <span style="color: orange;">Orange - Noisy Critical Points</span>, <span style="color: blue;">Blue - Noisy Data Points</span> </div> <p>We display the critical points computed on the noisy data set over the exact surface</p> <iframe src="/assets/plotly/CrossInTray/CrossInTray_surf_noisy_pts.html" width="100%" height="800px" frameborder="0"></iframe> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Georgy Scholten. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="" integrity="" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="" integrity="" crossorigin="anonymous"></script> <script defer src="" integrity="" crossorigin="anonymous"></script> <script defer src="" integrity="" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="" integrity="" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="" integrity="" crossorigin="anonymous"></script> <script defer src="" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>